from unittest import TestCase
from infras.clients.weather_livedoor_client import WeatherLivedoorClient
from settings import CITY_CODE_KAGOSHIMA


class TestWeatherLivedoorClient(TestCase):

    def test_get_city_weather(self):

        # 1/31でのテスト
        kagoshima_weather_forecast = (b'{"pinpointLocations":[{"link":"http://weather.livedoor.com/area/forecast'
                                      b'/4620100","name":"\\u9e7f\\u5150\\u5cf6\\u5e02"},'
                                      b'{"link":"http://weather.livedoor.com/area/forecast/4620400",'
                                      b'"name":"\\u6795\\u5d0e\\u5e02"},'
                                      b'{"link":"http://weather.livedoor.com/area/forecast/4620600",'
                                      b'"name":"\\u963f\\u4e45\\u6839\\u5e02"},'
                                      b'{"link":"http://weather.livedoor.com/area/forecast/4620800",'
                                      b'"name":"\\u51fa\\u6c34\\u5e02"},'
                                      b'{"link":"http://weather.livedoor.com/area/forecast/4621000",'
                                      b'"name":"\\u6307\\u5bbf\\u5e02"},'
                                      b'{"link":"http://weather.livedoor.com/area/forecast/4621501",'
                                      b'"name":"\\u85a9\\u6469\\u5ddd\\u5185\\u5e02"},'
                                      b'{"link":"http://weather.livedoor.com/area/forecast/4621502",'
                                      b'"name":"\\u85a9\\u6469\\u5ddd\\u5185\\u5e02\\u7511\\u5cf6"},'
                                      b'{"link":"http://weather.livedoor.com/area/forecast/4621600",'
                                      b'"name":"\\u65e5\\u7f6e\\u5e02"},'
                                      b'{"link":"http://weather.livedoor.com/area/forecast/4621800",'
                                      b'"name":"\\u9727\\u5cf6\\u5e02"},'
                                      b'{"link":"http://weather.livedoor.com/area/forecast/4621900",'
                                      b'"name":"\\u3044\\u3061\\u304d\\u4e32\\u6728\\u91ce\\u5e02"},'
                                      b'{"link":"http://weather.livedoor.com/area/forecast/4622000",'
                                      b'"name":"\\u5357\\u3055\\u3064\\u307e\\u5e02"},'
                                      b'{"link":"http://weather.livedoor.com/area/forecast/4622300",'
                                      b'"name":"\\u5357\\u4e5d\\u5dde\\u5e02"},'
                                      b'{"link":"http://weather.livedoor.com/area/forecast/4622400",'
                                      b'"name":"\\u4f0a\\u4f50\\u5e02"},'
                                      b'{"link":"http://weather.livedoor.com/area/forecast/4622500",'
                                      b'"name":"\\u59f6\\u826f\\u5e02"},'
                                      b'{"link":"http://weather.livedoor.com/area/forecast/4639200",'
                                      b'"name":"\\u3055\\u3064\\u307e\\u753a"},'
                                      b'{"link":"http://weather.livedoor.com/area/forecast/4640400",'
                                      b'"name":"\\u9577\\u5cf6\\u753a"},'
                                      b'{"link":"http://weather.livedoor.com/area/forecast/4645200",'
                                      b'"name":"\\u6e67\\u6c34\\u753a"}],'
                                      b'"link":"http://weather.livedoor.com/area/forecast/460010","forecasts":[{'
                                      b'"dateLabel":"\\u4eca\\u65e5","telop":"\\u66c7\\u308a","date":"2019-01-31",'
                                      b'"temperature":{"min":null,"max":null},"image":{"width":50,'
                                      b'"url":"http://weather.livedoor.com/img/icon/8.gif","title":"\\u66c7\\u308a",'
                                      b'"height":31}},{"dateLabel":"\\u660e\\u65e5",'
                                      b'"telop":"\\u66c7\\u306e\\u3061\\u6674","date":"2019-02-01","temperature":{'
                                      b'"min":{"celsius":"6","fahrenheit":"42.8"},"max":{"celsius":"11",'
                                      b'"fahrenheit":"51.8"}},"image":{"width":50,'
                                      b'"url":"http://weather.livedoor.com/img/icon/12.gif",'
                                      b'"title":"\\u66c7\\u306e\\u3061\\u6674","height":31}},'
                                      b'{"dateLabel":"\\u660e\\u5f8c\\u65e5","telop":"\\u6674\\u308c",'
                                      b'"date":"2019-02-02","temperature":{"min":null,"max":null},'
                                      b'"image":{"width":50,"url":"http://weather.livedoor.com/img/icon/1.gif",'
                                      b'"title":"\\u6674\\u308c","height":31}}],"location":{'
                                      b'"city":"\\u9e7f\\u5150\\u5cf6","area":"\\u4e5d\\u5dde",'
                                      b'"prefecture":"\\u9e7f\\u5150\\u5cf6\\u770c"},'
                                      b'"publicTime":"2019-01-31T17:00:00\\u002b0900","copyright":{"provider":[{'
                                      b'"link":"http://tenki.jp/",'
                                      b'"name":"\\u65e5\\u672c\\u6c17\\u8c61\\u5354\\u4f1a"}],'
                                      b'"link":"http://weather.livedoor.com/","title":"(C) LINE Corporation",'
                                      b'"image":{"width":118,"link":"http://weather.livedoor.com/",'
                                      b'"url":"http://weather.livedoor.com/img/cmn/livedoor.gif","title":"livedoor '
                                      b'\\u5929\\u6c17\\u60c5\\u5831","height":26}},'
                                      b'"title":"\\u9e7f\\u5150\\u5cf6\\u770c \\u9e7f\\u5150\\u5cf6 '
                                      b'\\u306e\\u5929\\u6c17","description":{"text":" '
                                      b'\\u4e5d\\u5dde\\u5357\\u90e8\\u30fb\\u5944\\u7f8e\\u5730\\u65b9\\u306f\\u3001'
                                      b'\\u66c7\\u308a\\u3067\\u96e8\\u304c\\u964d\\u3063\\u3066\\u3044\\u308b\\u6240'
                                      b'\\u304c\\u3042\\u308a\\u307e\\u3059\\u3002\\n\\n '
                                      b'\\u4e5d\\u5dde\\u5357\\u90e8\\u306f\\u300131\\u65e5\\u306f\\u4f4e\\u6c17'
                                      b'\\u5727\\u3084\\u524d\\u7dda\\u306e\\u5f71\\u97ff\\u3092\\u53d7\\u3051\\u308b'
                                      b'\\u3067\\u3057\\u3087\\u3046\\u30022\\u67081\\u65e5\\u306f\\n\\u9ad8\\u6c17'
                                      b'\\u5727\\u306b\\u8986\\u308f\\u308c\\u307e\\u3059\\u304c\\u3001\\u5bd2\\u6c17'
                                      b'\\u306e\\u5f71\\u97ff\\u3092\\u53d7\\u3051\\u308b\\u6240\\u304c\\u3042\\u308b'
                                      b'\\u898b\\u8fbc\\u307f\\u3067\\u3059\\u3002\\n '
                                      b'\\u5944\\u7f8e\\u5730\\u65b9\\u306f\\u300131\\u65e5\\u306f\\u6e7f\\u3063'
                                      b'\\u305f\\u7a7a\\u6c17\\u3084\\u524d\\u7dda\\u306e\\u5f71\\u97ff\\u3092\\u53d7'
                                      b'\\u3051\\u308b\\u3067\\u3057\\u3087\\u3046\\u30022\\u67081\\n\\u65e5\\u306f'
                                      b'\\u5bd2\\u6c17\\u306e\\u5f71\\u97ff\\u3092\\u53d7\\u3051\\u308b\\u898b\\u8fbc'
                                      b'\\u307f\\u3067\\u3059\\u3002\\n\\n '
                                      b'\\u4e5d\\u5dde\\u5357\\u90e8\\u3067\\u306f\\u300131\\u65e5\\u306f\\u6982'
                                      b'\\u306d\\u66c7\\u308a\\u3067\\u96e8\\u306e\\u964d\\u308b\\u6240\\u304c\\u3042'
                                      b'\\u308b\\u3067\\u3057\\u3087\\u3046\\u30022\\u67081\\u65e5\\n\\u306f\\u6771'
                                      b'\\u30b7\\u30ca\\u6d77\\u5074\\u3067\\u306f\\u6982\\u306d\\u66c7\\u308a\\u3067'
                                      b'\\u6b21\\u7b2c\\u306b\\u6674\\u308c\\u308b\\u6240\\u304c\\u3042\\u308a\\u307e'
                                      b'\\u3059\\u304c\\u3001\\u592a\\u5e73\\u6d0b\\u5074\\u3067\\u306f\\u6982\\n'
                                      b'\\u306d\\u6674\\u308c\\u306e\\u898b\\u8fbc\\u307f\\u3067\\u3059\\u3002\\n '
                                      b'\\u5944\\u7f8e\\u5730\\u65b9\\u3067\\u306f\\u300131\\u65e5\\u306f\\u96e8'
                                      b'\\u3067\\u96f7\\u3092\\u4f34\\u3046\\u6240\\u304c\\u3042\\u308a\\u307e\\u3059'
                                      b'\\u304c\\u6b21\\u7b2c\\u306b\\u66c7\\u308a\\u3068\\u306a\\u308b\\u3067\\n'
                                      b'\\u3057\\u3087\\u3046\\u30022\\u67081\\u65e5\\u306f\\u6982\\u306d\\u66c7'
                                      b'\\u308a\\u3067\\u96e8\\u306e\\u964d\\u308b\\u6240\\u304c\\u3042\\u308b\\u898b'
                                      b'\\u8fbc\\u307f\\u3067\\u3059\\u3002\\n\\n '
                                      b'\\u6d77\\u4e0a\\u3067\\u306f\\u300131\\u65e5\\u304b\\u30892\\u67081\\u65e5'
                                      b'\\u306b\\u304b\\u3051\\u3066\\u6ce2\\u304c\\u9ad8\\u304f\\u3057\\u3051\\u308b'
                                      b'\\u6240\\u304c\\u3042\\u308b\\u3067\\u3057\\u3087\\u3046\\n\\u3002\\n\\n '
                                      b'\\u685c\\u5cf6\\u4e0a\\u7a7a\\u304a\\u3088\\u305d1500\\u30e1\\u30fc\\u30c8'
                                      b'\\u30eb\\u306e\\u98a8\\n 31\\u65e515\\u6642    '
                                      b'\\u897f\\u306e\\u98a834\\u30e1\\u30fc\\u30c8\\u30eb\\n '
                                      b'1\\u65e509\\u6642\\u306e\\u4e88\\u60f3 '
                                      b'\\u5317\\u897f\\u306e\\u98a817\\u30e1\\u30fc\\u30c8\\u30eb\\n\\n\\u003c'
                                      b'\\u5929\\u6c17\\u5909\\u5316\\u7b49\\u306e\\u7559\\u610f\\u70b9\\u003e\\n '
                                      b'\\u5c4b\\u4e45\\u5cf6\\u753a\\u3067\\u306f\\u300131\\u65e5\\u306f\\u306f'
                                      b'\\u3058\\u3081\\u96e8\\u3067\\u3059\\u304c\\u6b21\\u7b2c\\u306b\\u66c7\\u308a'
                                      b'\\u3068\\u306a\\u308b\\u3067\\u3057\\u3087\\u3046\\u30022\\u6708\\n1\\u65e5'
                                      b'\\u306f\\u66c7\\u308a\\u3067\\u671d\\u6669\\u306f\\u6674\\u308c\\u308b\\u898b'
                                      b'\\u8fbc\\u307f\\u3067\\u3059\\u3002\\n '
                                      b'\\u5c4b\\u4e45\\u5cf6\\u753a\\u3067\\u306f\\u30012\\u67081\\u65e5\\u306b'
                                      b'\\u304b\\u3051\\u3066\\u5f37\\u98a8\\u3001\\u9ad8\\u6ce2\\u306b\\u6ce8\\u610f'
                                      b'\\u3057\\u3066\\u304f\\u3060\\u3055\\u3044\\u3002",'
                                      b'"publicTime":"2019-01-31T16:44:00\\u002b0900"}}').decode('utf-8')

        response_body = WeatherLivedoorClient.get_city_weather(city_code=CITY_CODE_KAGOSHIMA)

        print(response_body)

        self.assertEqual(kagoshima_weather_forecast, response_body)

